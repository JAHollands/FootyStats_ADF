{
	"name": "df_transform_pl_stats",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_processed_pl_stats_2223",
						"type": "DatasetReference"
					},
					"name": "ProcessedPlStats"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_sql_pl_stats_2223",
						"type": "DatasetReference"
					},
					"name": "CopyToSQL",
					"rejectedDataLinkedService": {
						"referenceName": "ls_data_lake_footballdatajhsa",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "SelectColumns"
				}
			],
			"scriptLines": [
				"source(output(",
				"          DATE as date,",
				"          COUNTRY as string,",
				"          LEAGUE as string,",
				"          TYPE as string,",
				"          SEASON as string,",
				"          HOME_TEAM as string,",
				"          AWAY_TEAM as string,",
				"          FTR as string,",
				"          FTHG as integer,",
				"          FTAG as long,",
				"          HTR as string,",
				"          HTHG as integer,",
				"          HTAG as integer,",
				"          ETR as string,",
				"          ETHG as string,",
				"          ETAG as string,",
				"          PENR as string,",
				"          PENHG as string,",
				"          PENAG as string,",
				"          H_ST as integer,",
				"          H_SOG as integer,",
				"          H_SFG as integer,",
				"          H_PT as integer,",
				"          H_COR as integer,",
				"          H_FL as integer,",
				"          H_YC as integer,",
				"          H_RC as integer,",
				"          A_ST as integer,",
				"          A_SOG as integer,",
				"          A_SFG as integer,",
				"          A_PT as integer,",
				"          A_COR as integer,",
				"          A_FL as integer,",
				"          A_YC as integer,",
				"          A_RC as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> ProcessedPlStats",
				"ProcessedPlStats select(mapColumn(",
				"          DATE,",
				"          COUNTRY,",
				"          LEAGUE,",
				"          TYPE,",
				"          SEASON,",
				"          HOME_TEAM,",
				"          AWAY_TEAM,",
				"          FTR_FullTimeResult = FTR,",
				"          FTHG_FullTimeHomeTeamGoals = FTHG,",
				"          FTAG_FullTimeAwayTeamGoals = FTAG,",
				"          HTR_HalfTimeResult = HTR,",
				"          HTHG_HalfTimeHomeTeamGoals = HTHG,",
				"          HTAG_HalfTimeAwayTeamGoals = HTAG,",
				"          H_ST_HomeTeamTotalShots = H_ST,",
				"          H_SOG_HomeTeamShotsOnGoal = H_SOG,",
				"          H_SFG_ShotsOffTarget = H_SFG,",
				"          H_PT_HomeTeamPossession = H_PT,",
				"          H_COR_HomeCorners = H_COR,",
				"          H_FL_HomeTeamFouls = H_FL,",
				"          H_YC_HomeYellowCards = H_YC,",
				"          H_RC_HomeRedCards = H_RC,",
				"          A_ST_AwayTeamTotalShots = A_ST,",
				"          A_SOG_AwayTeamShotsOnGoal = A_SOG,",
				"          A_SFG_AwayTeanOffTarget = A_SFG,",
				"          A_PT_AwayTeamPossession = A_PT,",
				"          A_COR_AwayTeamCorners = A_COR,",
				"          A_FL_AwayTeamFouls = A_FL,",
				"          A_YC_AwayTeamYellowCards = A_YC,",
				"          A_RC_AwayTeamRedCards = A_RC",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectColumns",
				"SelectColumns sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          DATE as date,",
				"          COUNTRY as string,",
				"          LEAGUE as string,",
				"          TYPE as string,",
				"          SEASON as string,",
				"          HOME_TEAM as string,",
				"          AWAY_TEAM as string,",
				"          FTR_FullTimeResult as string,",
				"          FTHG_FullTimeHomeTeamGoals as integer,",
				"          FTAG_FullTimeAwayTeamGoals as long,",
				"          HTR_HalfTimeResult as string,",
				"          HTHG_HalfTimeHomeTeamGoals as integer,",
				"          HTAG_HalfTimeAwayTeamGoals as integer,",
				"          H_ST_HomeTeamTotalShots as integer,",
				"          H_SOG_HomeTeamShotsOnGoal as integer,",
				"          H_SFG_ShotsOffTarget as integer,",
				"          H_PT_HomeTeamPossession as integer,",
				"          H_COR_HomeCorners as integer,",
				"          H_FL_HomeTeamFouls as integer,",
				"          H_YC_HomeYellowCards as integer,",
				"          H_RC_HomeRedCards as integer,",
				"          A_ST_AwayTeamTotalShots as integer,",
				"          A_SOG_AwayTeamShotsOnGoal as integer,",
				"          A_SFG_AwayTeanOffTarget as integer,",
				"          A_PT_AwayTeamPossession as integer,",
				"          A_COR_AwayTeamCorners as integer,",
				"          A_FL_AwayTeamFouls as integer,",
				"          A_YC_AwayTeamYellowCards as integer,",
				"          A_RC_AwayTeamRedCards as integer",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     truncate:true,",
				"     format: 'table',",
				"     dateFormat:'dd/MM/yyyy',",
				"     timestampFormat:'MM/dd/yyyy HH:mm:ss',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     outputRejectedData: true) ~> CopyToSQL"
			]
		}
	}
}