{
	"name": "df_transform_pl_stats",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_processed_pl_stats_2223",
						"type": "DatasetReference"
					},
					"name": "ProcessedPlStats"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "SelectColumns"
				}
			],
			"scriptLines": [
				"source(output(",
				"          DATE as date,",
				"          COUNTRY as string,",
				"          LEAGUE as string,",
				"          TYPE as string,",
				"          SEASON as string,",
				"          HOME_TEAM as string,",
				"          AWAY_TEAM as string,",
				"          FTR as string,",
				"          FTHG as short,",
				"          FTAG as short,",
				"          HTR as string,",
				"          HTHG as short,",
				"          HTAG as short,",
				"          ETR as string,",
				"          ETHG as string,",
				"          ETAG as string,",
				"          PENR as string,",
				"          PENHG as string,",
				"          PENAG as string,",
				"          H_ST as short,",
				"          H_SOG as short,",
				"          H_SFG as short,",
				"          H_PT as short,",
				"          H_COR as short,",
				"          H_FL as short,",
				"          H_YC as short,",
				"          H_RC as short,",
				"          A_ST as short,",
				"          A_SOG as short,",
				"          A_SFG as short,",
				"          A_PT as short,",
				"          A_COR as short,",
				"          A_FL as short,",
				"          A_YC as short,",
				"          A_RC as boolean",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> ProcessedPlStats",
				"ProcessedPlStats select(mapColumn(",
				"          DATE,",
				"          COUNTRY,",
				"          LEAGUE,",
				"          TYPE,",
				"          SEASON,",
				"          HOME_TEAM,",
				"          AWAY_TEAM,",
				"          FTR_FullTimeResult = FTR,",
				"          FTHG_FullTimeHomeTeamGoals = FTHG,",
				"          FTAG_FullTimeAwayTeamGoals = FTAG,",
				"          HTR_HalfTimeResult = HTR,",
				"          HTHG_HalfTimeHomeTeamGoals = HTHG,",
				"          HTAG_HalfTimeAwayGoals = HTAG,",
				"          ETR_ = ETR,",
				"          ETHG,",
				"          ETAG,",
				"          PENR,",
				"          PENHG,",
				"          PENAG,",
				"          H_ST_HomeTeamTotalShots = H_ST,",
				"          H_SOG_HomeTeamShotsOnGoal = H_SOG,",
				"          H_SFG_HomeTeamShotsOffTarget = H_SFG,",
				"          H_PT_HomeTeamPossession = H_PT,",
				"          H_COR_HomeTeamCorners = H_COR,",
				"          H_FL_HomeTeamFouls = H_FL,",
				"          H_YC_HomeTeamYellowCards = H_YC,",
				"          H_RC_HomeTeamRedCards = H_RC,",
				"          A_ST_AwayTeamTotalShots = A_ST,",
				"          A_SOG_AwayTeamShotsOnGoal = A_SOG,",
				"          A_SFG_AwayTeamShotsOnTarget = A_SFG,",
				"          A_PT_AwayTeamPossession = A_PT,",
				"          A_COR_AwayTeamCorners = A_COR,",
				"          A_FL_AwayTeamFouls = A_FL,",
				"          A_YC_AwayTeamYellowCards = A_YC,",
				"          A_RC_AwayTeamRedCards = A_RC",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectColumns"
			]
		}
	}
}