{
	"name": "df_transform_pl_stats",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_processed_pl_stats_2223",
						"type": "DatasetReference"
					},
					"name": "ProcessedPlStats"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_sql_pl_stats_2223",
						"type": "DatasetReference"
					},
					"name": "CopyToSQL"
				}
			],
			"transformations": [
				{
					"name": "SelectColumns"
				}
			],
			"scriptLines": [
				"source(output(",
				"          DATE as date,",
				"          COUNTRY as string,",
				"          LEAGUE as string,",
				"          TYPE as string,",
				"          SEASON as string,",
				"          HOME_TEAM as string,",
				"          AWAY_TEAM as string,",
				"          FTR as string,",
				"          FTHG as short,",
				"          FTAG as short,",
				"          HTR as string,",
				"          HTHG as short,",
				"          HTAG as short,",
				"          ETR as string,",
				"          ETHG as string,",
				"          ETAG as string,",
				"          PENR as string,",
				"          PENHG as string,",
				"          PENAG as string,",
				"          H_ST as short,",
				"          H_SOG as short,",
				"          H_SFG as short,",
				"          H_PT as short,",
				"          H_COR as short,",
				"          H_FL as short,",
				"          H_YC as short,",
				"          H_RC as short,",
				"          A_ST as short,",
				"          A_SOG as short,",
				"          A_SFG as short,",
				"          A_PT as short,",
				"          A_COR as short,",
				"          A_FL as short,",
				"          A_YC as short,",
				"          A_RC as short",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> ProcessedPlStats",
				"ProcessedPlStats select(mapColumn(",
				"          DATE,",
				"          COUNTRY,",
				"          LEAGUE,",
				"          TYPE,",
				"          SEASON,",
				"          HOME_TEAM,",
				"          AWAY_TEAM,",
				"          FTR_FullTimeResult = FTR,",
				"          FTHG_FullTimeHomeTeamGoals = FTHG,",
				"          FTAG_FullTimeAwayTeamGoals = FTAG,",
				"          HTR_HalfTimeResult = HTR,",
				"          HTHG_HalfTimeHomeTeamGoals = HTHG,",
				"          HTAG_HalfTimeAwayGoals = HTAG,",
				"          H_ST_HomeTeamTotalShots = H_ST,",
				"          H_SOG_HomeTeamShotsOnGoal = H_SOG,",
				"          H_SFG_HomeTeamShotsOffTarget = H_SFG,",
				"          H_PT_HomeTeamPossession = H_PT,",
				"          H_COR_HomeTeamCorners = H_COR,",
				"          H_FL_HomeTeamFouls = H_FL,",
				"          H_YC_HomeTeamYellowCards = H_YC,",
				"          H_RC_HomeTeamRedCards = H_RC,",
				"          A_ST_AwayTeamTotalShots = A_ST,",
				"          A_SOG_AwayTeamShotsOnGoal = A_SOG,",
				"          A_SFG_AwayTeamShotsOffTarget = A_SFG,",
				"          A_PT_AwayTeamPossession = A_PT,",
				"          A_COR_AwayTeamCorners = A_COR,",
				"          A_FL_AwayTeamFouls = A_FL,",
				"          A_YC_AwayTeamYellowCards = A_YC,",
				"          A_RC_AwayTeamRedCards = A_RC",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectColumns",
				"SelectColumns sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          DATE as date,",
				"          COUNTRY as string,",
				"          LEAGUE as string,",
				"          TYPE as string,",
				"          SEASON as string,",
				"          HOME_TEAM as string,",
				"          AWAY_TEAM as string,",
				"          FTR_FullTimeResult as string,",
				"          FTHG_FullTimeHomeTeamGoals as integer,",
				"          FTAG_FullTimeAwayTeamGoals as long,",
				"          HTR_HalfTimeResult as string,",
				"          HTHG_HalfTimeHomeTeamGoals as integer,",
				"          HTAG_HalfTimeAwayTeamGoals as integer,",
				"          H_ST_HomeTeamTotalShots as integer,",
				"          H_SOG_HomeTeamShotsOnGoal as integer,",
				"          H_SFG_ShotsOffTarget as integer,",
				"          H_PT_HomeTeamPossession as integer,",
				"          H_COR_HomeCorners as integer,",
				"          H_FL_HomeTeamFouls as integer,",
				"          H_YC_HomeYellowCards as integer,",
				"          H_RC_HomeRedCards as integer,",
				"          A_ST_AwayTeamTotalShots as integer,",
				"          A_SOG_AwayTeamShotsOnGoal as integer,",
				"          A_SFG_AwayTeanOffTarget as integer,",
				"          A_PT_AwayTeamPossession as integer,",
				"          A_COR_AwayTeamCorners as integer,",
				"          A_FL_AwayTeamFouls as integer,",
				"          A_YC_AwayTeamYellowCards as integer,",
				"          A_RC_AwayTeamRedCards as integer",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          DATE,",
				"          COUNTRY,",
				"          LEAGUE,",
				"          TYPE,",
				"          SEASON,",
				"          HOME_TEAM,",
				"          AWAY_TEAM,",
				"          FTR_FullTimeResult,",
				"          FTHG_FullTimeHomeTeamGoals,",
				"          FTAG_FullTimeAwayTeamGoals,",
				"          HTR_HalfTimeResult,",
				"          HTHG_HalfTimeHomeTeamGoals,",
				"          HTAG_HalfTimeAwayTeamGoals = HTAG_HalfTimeAwayGoals,",
				"          H_ST_HomeTeamTotalShots,",
				"          H_SOG_HomeTeamShotsOnGoal,",
				"          H_SFG_ShotsOffTarget = H_SFG_HomeTeamShotsOffTarget,",
				"          H_PT_HomeTeamPossession,",
				"          H_COR_HomeCorners = H_COR_HomeTeamCorners,",
				"          H_FL_HomeTeamFouls,",
				"          H_YC_HomeYellowCards = H_YC_HomeTeamYellowCards,",
				"          H_RC_HomeRedCards = H_RC_HomeTeamRedCards,",
				"          A_ST_AwayTeamTotalShots,",
				"          A_SOG_AwayTeamShotsOnGoal,",
				"          A_SFG_AwayTeanOffTarget = A_SFG_AwayTeamShotsOffTarget,",
				"          A_PT_AwayTeamPossession,",
				"          A_COR_AwayTeamCorners,",
				"          A_FL_AwayTeamFouls,",
				"          A_YC_AwayTeamYellowCards,",
				"          A_RC_AwayTeamRedCards",
				"     )) ~> CopyToSQL"
			]
		}
	}
}